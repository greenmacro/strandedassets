---
title: "No Transition Scenario Analysis"
author: "Antoine Godin"
date: "25 October 2017"
output: 
  pdf_document: 
    keep_tex: yes
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
load("NoTransitionAnalysis.Rdata")
library(knitr)
library(plotrix)
```

# Transition from brown to green

We are here in the case of a sensitivity analysis on both parameters, using the latin hypercube [TODO: add stuff about that, reference to Salle and Yildigluzu]. We run 33 models, using the design experiment within domain space $D:\theta \in [0,0.4] \times \phi [0.04]$. The parameters tested can be found in appendix.

This section analyses the effect of the two parameters on the following set of indicators which relates to the outcome of the transition:

- *exit period*: how long before the high-carbon sector exits the market 
- *real stranded assets*: value of the capital stock owned by the high-carbon sector in the period before the exit period
- *financial stranded assets*: market capitalisation of the high-carbon capital sector in the period before the exit period
- *output volatility*: defined as the sum of the coefficient of variation of each of the three sector real output

We use one lag values for the stranded asset because the exit period might be triggered by three different conditions: non-postive profit in the high-carbon sector, non-positive output in the high-carbon sector or non-positive price of high-carbon equity. 


Most of the sensitivity graphs (see hereunder) show that (i) the apathy parameter dominates the effect of the blindness parameter for all the parameters but for the volatility indicator, (ii) that the larger the value of the $\theta$ parameter, the longer the transition lasts (up to the point where avlues of $\theta$ above 0.4 lead to no transition at all), and (iii) that there are non-linear effects emerging.

![Exit Period](plots/final/exitPeriod.png)

![Real Stranded Assets](plots/final/PhysicalStranded.png)

![Financial Stranded Assets](plots/final/FinancialCapitalisation.png)

![Output Volatility](plots/final/OutputVolatility.png)

In the domain exploration, 6 scenarios lead to no transition at all. This will be at the center of the analysis of the next section. It is worth noting that $\theta$ is not the only explanatory factor as the combination of specific values of the two parameters might lead to transition or no transition for values that are similar. This indicates that there are path dependency impacts and knife-edge dynamics at work. The specific impact of the blindness parameter, for a given level of apathy will be analysed in a following section.

Non linear impacts of the apathy parameter seem to start for value larger than $0.1$. This is confirmed by a sensitivity analysis (not shown) over the domain $(\theta,\phi)\in [0,0.1]$. The impact of financial apathy is larger for values around 0.2 than for values around 0.3. The analysis hereunder will show that this is due to stock effects arising from financial apathy and blindness. In a nutshell, the portfolio specification leads to re-allocation between low-carbon and high-carbon sectors but also between capital and consumption sectors. This in turn triggers non-trivial impacts on investment, employment and hence total output but also to the relative size of each sector. Each of the two recession period (when the low-carbon ermerges in the capital good market and when it enters the financial market) have more or less pronounced effect depending on these relative sectorial size. In certain cases, the economy settles into low capital stock regime (due to the growth function), implying an already deflated capital stock into the high-carbon sector, which leads to a smoother transition.

# Scenario anlysis

The analysis here compare the dynamics of the baseline scenario with a case of no transition ($\theta=0.35$ and $\phi=0.175$)

## Before the IPO

As soon as the green sector enters the capital good market, it starts eating market share to the brown sector. When doing so it impacts the brown sector growth rate. When financial investor are more apathetic and blinder, they give more weight to what they think should be the level of capital stock in the brown sector and hence inflate or deflate the expected present value of the brown capital stock, leading to a different prices of equity for the brown sector *and for the consumption sector*. Indeed, the green sector is not present on the financial market yet, but financial investor already start favouring the brown sector due to their apathy and blindness. 

This leads to different growth rate in each sector, leading to different investment decision. Overall, the impact is positive in terms of output, employment and labor income. This dyanmic is reinforced as the observed growth rates feed into the financial appreciation of potential value for capital stocks. Furthermore, higher labor income leads to increased consumption and reverts the initial negative impact on the consumption sector.

Once this happens, the expected growth rate in the consumption sector takes over the expected growth rates in the brown capital scetor and we observe a reversal of the trends due to financial re-allocation of funds: reduced (and eventually negative) growth in the capital sector, decrease in output and employment. Note that this has no effect on the green sector.

```{r, echo=FALSE}
tempf<-fail[21:41,c("Yc","Yh","Yl")]
tempf$GDP<-tempf$Yc+tempf$Yh+tempf$Yl
temp<-suc[21:41,c("Yc","Yh","Yl")]
temp$GDP<-temp$Yc+temp$Yh+temp$Yl

#add legend
dif<-tempf-temp
difpos<-dif[,c("Yc","Yh","Yl")]/temp$GDP
difpos[difpos<0]<-0
difneg<-dif[,c("Yc","Yh","Yl")]/temp$GDP
difneg[difneg>0]<-0

#for the ylim, if necessary round(100*min(rowSums(difneg)),digits=1), round(100*max(rowSums(difpos)),digits=2)
png(filename=paste("plots/final/NoTransitionGDP.png",sep=""),width=1440,height=960,pointsize = 20)
df.bar<-barplot(100*t(as.matrix(difpos)), main="Changes in GDP components as % of GDP", xlab="", ylim=c(-0.05,0.05), border="white", col=c("lightblue","lightcoral","lightgreen"))
df.bar<-barplot(100*t(as.matrix(difneg)), main="", xlab="", add=TRUE, border="white", col=c("lightblue","lightcoral","lightgreen"), axes=F)
points(x = df.bar, y=100*dif$GDP/temp$GDP,lwd=1,pch=5)
legend("bottomleft", legend=c("Consumption","High-Carbon","Low-Carbon"), bty='n', col=c("lightblue","lightcoral","lightgreen"), fill=c("lightblue","lightcoral","lightgreen"), border="white")
grid()
legend(x=-2,y=-0.3,legend=c("GDP"),bty='n',col=c(1),pch=5,x.intersp = 1.3)
```

The effact on the capital stock are more striking, more blindness leaves the economy with a lower capital stock in the brown sector and in the consumption sector, as a result of the dynamics we described hereabove. Overall, the economy has a lower GDP and a lower stock of capital. Lower capital stock in the aggregate leads to lower debt level (given the targeted leverage level), implying that money holding by households is lower, but this is partially compensated by a higher level of total market capitalisation.

```{r, echo=FALSE}
tempf<-fail[21:41,c("khc","klc","khh","kll","khl")]
tempf$capStock<-rowSums(tempf)
temp<-suc[21:41,c("khc","klc","khh","kll","khl")]
temp$capStock<-rowSums(temp)

#add legend
dif<-tempf-temp
difpos<-dif[,c("khc","khh","klc","kll","khl")]/temp$capStock
difpos[difpos<0]<-0
difneg<-dif[,c("khc","khh","klc","kll","khl")]/temp$capStock
difneg[difneg>0]<-0

#for the ylim, if necessary round(100*min(rowSums(difneg)),digits=1), round(100*max(rowSums(difpos)),digits=2)

df.bar<-barplot(100*t(as.matrix(difpos)), main="Changes in capital stocks as % of total capital sctock", xlab="", ylim=c(-0.04,0.04), border="white", col=c("lightblue","lightcoral","lightgreen"))
df.bar<-barplot(100*t(as.matrix(difneg)), main="", xlab="", add=TRUE, border="white", col=c("lightblue","lightcoral","lightgreen"), axes=F)
points(x = df.bar, y=100*dif$capStock/temp$capStock,lwd=1,pch=5)
legend("bottomleft", legend=c("Consumption","High-Carbon","Low-Carbon"), bty='n', col=c("lightblue","lightcoral","lightgreen"), fill=c("lightblue","lightcoral","lightgreen"), border="white")
grid()
legend(x=-0.5,y=-0.19,legend=c("Change in total capital stock"),bty='n',col=c(1),pch=5,x.intersp = 1.3)
```



```{r, echo=FALSE}
tempf<-fail[21:40,c("Vw","pce","phe","ple","Mf")]
tempf$pce<-tempf$pce*100
tempf$phe<-tempf$phe*100
tempf$ple<-tempf$ple*50
tempf$totWealth<-rowSums(tempf)
tempf$finWealth<-rowSums(tempf[c("pce","phe","ple")])
tempf$moneyStock<-rowSums(tempf[c("Mf","Vw")])
temp<-suc[21:40,c("Vw","pce","phe","ple","Mf")]
temp$pce<-temp$pce*100
temp$phe<-temp$phe*100
temp$ple<-temp$ple*50
temp$totWealth<-rowSums(temp)
temp$finWealth<-rowSums(temp[c("pce","phe","ple")])
temp$moneyStock<-rowSums(temp[c("Mf","Vw")])


#add legend
dif<-tempf-temp
difpos<-dif[,c("moneyStock","finWealth")]/temp$totWealth
difpos[difpos<0]<-0
difneg<-dif[,c("moneyStock","finWealth")]/temp$totWealth
difneg[difneg>0]<-0

#for the ylim, if necessary round(100*min(rowSums(difneg)),digits=1), round(100*max(rowSums(difpos)),digits=2)

df.bar<-barplot(100*t(as.matrix(difpos)), main="Changes in capital stocks as % of total capital sctock", xlab="", ylim=c(-0.02,0.02), border="white", col=c("lightblue","lightcoral","lightgreen"))
df.bar<-barplot(100*t(as.matrix(difneg)), main="", xlab="", add=TRUE, border="white", col=c("lightblue","lightcoral","lightgreen"), axes=F)
points(x = df.bar, y=100*dif$totWealth/temp$totWealth,lwd=1,pch=5)
legend("bottomleft", legend=c("Money","Equity"), bty='n', col=c("lightblue","lightcoral","lightgreen"), fill=c("lightblue","lightcoral","lightgreen"), border="white")
grid()
legend(x=-0.5,y=-0.07,legend=c("Change in total wealth"),bty='n',col=c(1),pch=5,x.intersp = 1.3)
```

## IPO and after

The behaviours of financial investors is such that part of the green growth is transfered to the capital good sector, leading to a much smaller shock (20% lower) to both the brown capital sector *and the consumption sector*. Indeed as the expected present value of the green sector is decreased, leading to an increase of the brown sector, the expected present value of the consumption sector's capital stock remains proportionally higher. 


```{r, echo=FALSE}
tempf<-fail[40:53,c("pce","phe","ple","Vfe")]
tempf$pce<-tempf$pce*100
tempf$phe<-tempf$phe*100
tempf$ple<-tempf$ple*50
temp<-suc[40:53,c("pce","phe","ple","Vfe")]
temp$pce<-temp$pce*100
temp$phe<-temp$phe*100
temp$ple<-temp$ple*50

#add legend
dif<-tempf-temp
difpos<-dif[c("pce","phe","ple")]/temp$Vfe
difpos[difpos<0]<-0
difneg<-dif[c("pce","phe","ple")]/temp$Vfe
difneg[difneg>0]<-0

#for the ylim, if necessary round(100*min(rowSums(difneg)),digits=1), round(100*max(rowSums(difpos)),digits=2)

df.bar<-barplot(100*t(as.matrix(difpos)), main="Changes in financial capitalisation as % of financial wealth", xlab="", ylim=c(-40,60), border="white", col=c("lightblue","lightcoral","lightgreen"))
df.bar<-barplot(100*t(as.matrix(difneg)), main="", xlab="", add=TRUE, border="white", col=c("lightblue","lightcoral","lightgreen"), axes=F)
points(x = df.bar, y=100*dif$Vfe/temp$Vfe,lwd=1,pch=5)
legend("topright", legend=c("Consumption Equity","High-Carbon Equity","Low-Carbon Equity"), bty='n', col=c("lightblue","lightcoral","lightgreen"), fill=c("lightblue","lightcoral","lightgreen"), border="white")
grid()
legend(x=-0.5,y=-3.7,legend=c("Financial Wealth"),bty='n',col=c(1),pch=5,x.intersp = 1.3)
```

This also implies  a much higher financial wealth and thus higher consumption. We thus observe a much milder recession after the IPO.

```{r, echo=FALSE}
tempf<-fail[40:53,c("Yc","Yh","Yl")]
tempf$GDP<-tempf$Yc+tempf$Yh+tempf$Yl
temp<-suc[40:53,c("Yc","Yh","Yl")]
temp$GDP<-temp$Yc+temp$Yh+temp$Yl

#add legend
dif<-tempf-temp
difpos<-dif[,c("Yc","Yh","Yl")]/temp$GDP
difpos[difpos<0]<-0
difneg<-dif[,c("Yc","Yh","Yl")]/temp$GDP
difneg[difneg>0]<-0

#for the ylim, if necessary round(100*min(rowSums(difneg)),digits=1), round(100*max(rowSums(difpos)),digits=2)

df.bar<-barplot(t(as.matrix(tempf[c("Yc","Yh","Yl")])), main="GDP Components", xlab="", border="white", col=c("lightblue","lightcoral","lightgreen"),ylim=c(0,15000))
points(x = df.bar, y=temp$GDP,col="darkgreen",lwd=2,pch=5)
points(x = df.bar, y=temp$Yc,col="blue",lwd=2,pch=5)
points(x = df.bar, y=temp$Yc+temp$Yh,col="red",lwd=2,pch=5)
legend("bottomleft", legend=c("Consumption","High-Carbon","Low-Carbon"), bty='n', col=c("lightblue","lightcoral","lightgreen"), fill=c("lightblue","lightcoral","lightgreen"), border="white")
legend("bottomright", legend=c("Consumption","High-Carbon","Low-Carbon"), bty='n', col=c("blue","red","darkgreen"), pch=5,lwd=2, border="white")
```

The combination of the portfolio re-allocation and higher levels of GDP leads to a situation where the green sector doesn't grow as fast in the non-transition scenario as in the baseline case. On the other hand the brown and consumption sector grow much faster.

```{r, echo=FALSE}
tempf<-fail[40:53,c("khc","klc","khh","kll","khl")]
tempf$capStock<-rowSums(tempf)
tempf$cStock<-rowSums(tempf[c("khc","klc")])
tempf$hStock<-rowSums(tempf[c("khl","kll")])
temp<-suc[40:53,c("khc","klc","khh","kll","khl")]
temp$capStock<-rowSums(temp)
temp$cStock<-rowSums(temp[c("khc","klc")])
temp$hStock<-rowSums(temp[c("khl","kll")])

#add legend
dif<-tempf-temp
difpos<-dif[,c("cStock","khh","hStock")]/temp$capStock
difpos[difpos<0]<-0
difneg<-dif[,c("cStock","khh","hStock")]/temp$capStock
difneg[difneg>0]<-0

#for the ylim, if necessary round(100*min(rowSums(difneg)),digits=1), round(100*max(rowSums(difpos)),digits=2)

df.bar<-barplot(100*t(as.matrix(difpos)), main="Changes in capital stocks as % of total capital sctock", xlab="", ylim=c(-7,13), border="white", col=c("lightblue","lightcoral","lightgreen"))
df.bar<-barplot(100*t(as.matrix(difneg)), main="", xlab="", add=TRUE, border="white", col=c("lightblue","lightcoral","lightgreen"), axes=F)
points(x = df.bar, y=100*dif$capStock/temp$capStock,lwd=1,pch=5)
legend("bottomleft", legend=c("Consumption","High-Carbon","Low-Carbon"), bty='n', col=c("lightblue","lightcoral","lightgreen"), fill=c("lightblue","lightcoral","lightgreen"), border="white")
grid()
legend(x=-0.5,y=-0.32,legend=c("Change in total capital stock"),bty='n',col=c(1),pch=5,x.intersp = 1.3)
```

